{
	"person": {
		"name": "daniel goldsmith",
		"githubUsername": "dg01d",
		"imageURL": "https://avatars.githubusercontent.com/u/1061809?v=4",
		"bio": "",
		"primary": true
	},
	"plugins": [
		{
			"files": [
				{
					"path": "Sports/worldcup.1m.php",
					"filename": "worldcup.1m.php",
					"content": "#!/usr/bin/php\n\n\u003c?php\n\n/**\n * worldcup - BitBar WorldCup 2018 scores\n *\n * PHP version 7\n *\n * @author   Daniel Goldsmith \u003cdgold@ascraeus.org\u003e\n * @license  https://opensource.org/licenses/FPL-1.0.0 0BSD\n * @link     https://github.com/dg01d/bitbar-worldcup\n * @category Utility\n * @version  2.1\n * \u003cbitbar.title\u003eWorld Cup 2018\u003c/bitbar.title\u003e\n * \u003cbitbar.version\u003ev1.0\u003c/bitbar.version\u003e\n * \u003cbitbar.author\u003eDaniel Goldsmith\u003c/bitbar.author\u003e\n * \u003cbitbar.author.github\u003edg01d\u003c/bitbar.author.github\u003e\n * \u003cbitbar.desc\u003eShows current and daily scores from the 2018 World Cup. Needs Steve Edson's bitbar-php: https://github.com/SteveEdson/bitbar-php \u003c/bitbar.desc\u003e\n * \u003cbitbar.image\u003ehttps://raw.githubusercontent.com/dg01d/bitbar-worldcup/master/bitbar-worldcup.png\u003c/bitbar.image\u003e\n * \u003cbitbar.dependencies\u003ephp,bitbar-php\u003c/bitbar.dependencies\u003e\n * \u003cbitbar.abouturl\u003ehttps://github.com/dg01d/bitbar-worldcup\u003c/bitbar.abouturl\u003e\n * Instructions: Install bitbar-php following the instructions on that project's github page.\n * Uses the wonderful World Cup API provided by http://worldcup.sfg.io\n */\n\nrequire \".bitbar/vendor/autoload.php\";\n\nuse SteveEdson\\BitBar;\n\nfunction array_msort($array, $cols)\n{\n    $colarr = array();\n    foreach ($cols as $col =\u003e $order) {\n        $colarr[$col] = array();\n        foreach ($array as $k =\u003e $row) { $colarr[$col]['_'.$k] = strtolower($row[$col]); }\n    }\n    $eval = 'array_multisort(';\n    foreach ($cols as $col =\u003e $order) {\n        $eval .= '$colarr[\\''.$col.'\\'],'.$order.',';\n    }\n    $eval = substr($eval,0,-1).');';\n    eval($eval);\n    $ret = array();\n    foreach ($colarr as $col =\u003e $arr) {\n        foreach ($arr as $k =\u003e $v) {\n            $k = substr($k,1);\n            if (!isset($ret[$k])) $ret[$k] = $array[$k];\n            $ret[$k][$col] = $array[$k][$col];\n        }\n    }\n    return $ret;\n}\n\n\n$flagsrc = '{\"PAN\":\"🇵🇦\",\"TUN\":\"🇹🇳\",\"ENG\":\"🏴󠁧󠁢󠁥󠁮󠁧󠁿\",\"POL\":\"🇵🇱\",\"JPN\":\"🇯🇵\",\"COL\":\"🇨🇴\",\"SEN\":\"🇸🇳\",\"ARG\":\"🇦🇷\",\"ISL\":\"🇮🇸\",\"PER\":\"🇵🇪\",\"DEN\":\"🇩🇰\",\"CRO\":\"🇭🇷\",\"NGA\":\"🇳🇬\",\"RUS\":\"🇷🇺\",\"KSA\":\"🇸🇦\",\"EGY\":\"🇪🇬\",\"URU\":\"🇺🇾\",\"POR\":\"🇵🇹\",\"ESP\":\"🇪🇸\",\"MAR\":\"🇲🇦\",\"IRN\":\"🇮🇷\",\"FRA\":\"🇫🇷\",\"AUS\":\"🇦🇺\",\"BRA\":\"🇧🇷\",\"SUI\":\"🇨🇭\",\"CRC\":\"🇨🇷\",\"SRB\":\"🇷🇸\",\"GER\":\"🇩🇪\",\"MEX\":\"🇲🇽\",\"SWE\":\"🇸🇪\",\"KOR\":\"🇰🇷\",\"BEL\":\"🇧🇪\"}';\n\n$flags = json_decode($flagsrc, true);\n\n// Create BitBar formatter\n$bb = new BitBar();\n\n$json = file_get_contents(\"http://worldcup.sfg.io/matches/current\");\n$data = json_decode($json, true);\n\n\nif (!empty($data)) {\n    $homeTeam = $data[0]['home_team']['code'];\n    $homeTeamFlag= $flags[$homeTeam];\n    $homeTeamScore = $data[0]['home_team']['goals'];\n    $awayTeam = $data[0]['away_team']['code'];\n    $awayTeamFlag = $flags[$awayTeam];\n    $awayTeamScore = $data[0]['away_team']['goals'];\n    $scoreLine = \"$homeTeamFlag $homeTeamScore — $awayTeamScore $awayTeamFlag\";\n} else {\n    $scoreLine = \"⚽\";\n};\n\n$line = $bb-\u003enewLine();\n\n$line\n    -\u003esetText($scoreLine)\n    -\u003esetFontFace(\"SF Mono\")\n    -\u003eshow();\n\n$todayJson = file_get_contents(\"http://worldcup.sfg.io/matches/today\");\n$todayData = json_decode($todayJson, true);\n\nif (!empty($todayData)) {\n    $cnt = count($todayData);\n    for ($n = 0; $n \u003c $cnt; $n++) {\n        $team1 = $todayData[$n]['home_team']['country'];\n        $team1code =  $todayData[$n]['home_team']['code'];\n        $team1flag = $flags[$team1code];\n        $team1s = $todayData[$n]['home_team']['goals'];\n        $team2 = $todayData[$n]['away_team']['country'];\n        $team2code =  $todayData[$n]['away_team']['code'];\n        $team2flag = $flags[$team2code];\n        $team2s = $todayData[$n]['away_team']['goals'];\n\n        $scores = \"$team1code $team1flag $team1s – $team2s $team2flag $team2code\";\n        $match = \"\\\"https://www.fifa.com/worldcup/matches/match/\" . $todayData[$n]['fifa_id'] . \"/#match-summary\\\"\";\n        if (($todayData[$n]['status']) == \"in progress\") {\n            $time = $todayData[$n]['time'];\n            $scores = $scores . \" \" . $time . \" ⚽| href=$match\";\n        } else {\n            $scores .= \" | href=$match\";\n        }\n        if (($todayData[$n]['status'] == \"completed\") || ($todayData[$n]['status'] == \"in progress\")) {\n            $line = $bb-\u003enewLine();\n\n            $arrayEvents = array_merge($todayData[$n]['home_team_events'], $todayData[$n]['away_team_events']);\n            $arraySortEvents = array_msort($arrayEvents, array('id'=\u003eSORT_ASC));\n            foreach ($arraySortEvents as $val) {\n                if (in_array($val['type_of_event'], array('goal', \"goal-own\", \"goal-penalty\"))) {\n                    $scores .= \"\\n\\033[35m\";\n                    $scores .= $val['player'] . \" \" . $val['time'];\n                }\n                if ($val['type_of_event'] == \"goal-penalty\") {\n                    $scores .= \" (P)\";\n                }\n                if ($val['type_of_event'] == \"goal-own\") {\n                    $scores .= \" (OG)\";\n                }\n                if (in_array($val['type_of_event'], array('red-card', \"yellow-card\"))) {\n                    $scores .= \"\\n\\033[35m\";\n                    $scores .= $val['player'] . \" \" . $val['time'];\n                }\n                if ($val['type_of_event'] == \"yellow-card\") {\n                    $scores .= \" \\033[1;33m◼\\033[0m\";\n                }\n                if ($val['type_of_event'] == \"red-card\") {\n                    $scores .= \" \\033[1;31m◼\\033[0m\";\n                }\n                $scores .= \" | size=11\";\n            }\n            $comGame = $line\n                -\u003esetText($scores)\n                -\u003esetDropdown(true);\n            $comGame-\u003eshow();\n        } else {\n            $line = $bb-\u003enewLine();\n            $line\n                -\u003esetText($scores)\n                -\u003esetFontFace(\"SF Mono\")\n                -\u003esetDropdown(true)\n                -\u003eshow();\n        }\n    }\n}\n"
				}
			],
			"path": "Sports/worldcup.1m.php",
			"filename": "worldcup.1m.php",
			"dir": "Sports",
			"docsPlugin": "Sports/worldcup.1m.php.html",
			"docsCategory": "Sports.html",
			"pathSegments": [
				"Sports"
			],
			"categoryPathSegments": [
				{
					"path": "Sports",
					"text": "Sports",
					"isLast": true
				}
			],
			"title": "World Cup 2018",
			"version": "v1.0",
			"author": "Daniel Goldsmith",
			"authors": [
				{
					"name": "daniel goldsmith",
					"githubUsername": "dg01d",
					"imageURL": "https://avatars.githubusercontent.com/u/1061809?v=4",
					"bio": "",
					"primary": true
				}
			],
			"desc": "Shows current and daily scores from the 2018 World Cup. Needs Steve Edson's bitbar-php: https://github.com/SteveEdson/bitbar-php ",
			"imageURL": "https://raw.githubusercontent.com/dg01d/bitbar-worldcup/master/bitbar-worldcup.png",
			"dependencies": [
				"php",
				"bitbar-php"
			],
			"aboutURL": "https://github.com/dg01d/bitbar-worldcup",
			"lastUpdated": "2021-03-08T15:22:01.547599Z",
			"vars": null
		}
	]
}