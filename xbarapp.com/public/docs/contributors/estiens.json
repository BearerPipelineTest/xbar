{
	"person": {
		"name": "Eric Stiens",
		"githubUsername": "estiens",
		"imageURL": "https://avatars.githubusercontent.com/u/4022668?v=4",
		"bio": "code for good. code for change. code as a medium for magic. code for fun.",
		"primary": true
	},
	"plugins": [
		{
			"files": [
				{
					"path": "Music/lastfm.10s.rb",
					"filename": "lastfm.10s.rb",
					"content": "#!/usr/bin/env ruby\n\n# Get current or last played song from Last FM\n# by Eric Stiens\n#\n# Shows the last song played on Last.fm\n# (or scrobbled from another service)\n# Includes link to track info page in the dropdown\n\n# \u003cbitbar.title\u003eLast.fm Now Playing\u003c/bitbar.title\u003e\n# \u003cbitbar.version\u003ev1.0\u003c/bitbar.version\u003e\n# \u003cbitbar.author\u003eEric Stiens\u003c/bitbar.author\u003e\n# \u003cbitbar.author.github\u003eestiens\u003c/bitbar.author.github\u003e\n# \u003cbitbar.desc\u003eDisplays currently playing song from Last.fm (or scrobbles)\u003c/bitbar.desc\u003e\n# \u003cbitbar.image\u003ehttps://s3.amazonaws.com/f.cl.ly/items/400E102E353y3U1x2r2U/Screen%20Shot%202016-02-09%20at%2012.19.47%20PM.png?v=36addc99\u003c/bitbar.image\u003e\n# \u003cbitbar.dependencies\u003eruby, xml-simple\u003c/bitbar.dependencies\u003e\n\nrequire 'open-uri'\nrequire 'xmlsimple'\n\nUSERNAME = '' #lastfm username\nAPI_KEY = '' #lastfm API key\n\nclass LastfmPlugin\n  def initialize(username, api_key)\n    @username = username\n    @api_key = api_key\n    @output = nil\n  end\n\n  def call_api\n    begin\n      url = 'http://ws.audioscrobbler.com' + \"/2.0/?method=user.getrecenttracks\u0026user=#{@username}\u0026api_key=#{@api_key}\u0026limit=1\"\n      response = open(url).read\n      XmlSimple.xml_in(response, { 'ForceArray' =\u003e false })\n    rescue\n      @output = \"API error\"\n    end\n  end\n\n  def build_output\n    begin\n      response = call_api\n      song = response['recenttracks']['track'][0]\n      output_array = get_details_of_song(song)\n      @output = output_array.join(\"\\n\")\n    rescue\n      @output = \"API error\"\n    end\n  end\n\n  def get_details_of_song(song)\n    if song['nowplaying'] == 'true'\n      icon = '▶'\n      playing_string = 'Now Playing'\n    else\n      icon='❚❚'\n      playing_string = 'Last Played'\n    end\n    track = song['name']\n    artist = song['artist']['content']\n    album = song['album']['content']\n    output_array = []\n    output_array \u003c\u003c \"#{icon} #{track} | length=20\"\n    output_array \u003c\u003c '---'\n    output_array \u003c\u003c \"#{playing_string} | color = #333\"\n    output_array \u003c\u003c \"Track: #{track} | href = #{song['url']} color=#000080\"\n    output_array \u003c\u003c \"Album: #{album} | color = #333\"\n    output_array \u003c\u003c \"Artist: #{artist} | color = #333\"\n    output_array\n  end\n\n  def execute\n    build_output\n    puts @output\n  end\nend\n\nplugin = LastfmPlugin.new(USERNAME, API_KEY)\nplugin.execute\n"
				}
			],
			"path": "Music/lastfm.10s.rb",
			"filename": "lastfm.10s.rb",
			"dir": "Music",
			"docsPlugin": "Music/lastfm.10s.rb.html",
			"docsCategory": "Music.html",
			"pathSegments": [
				"Music"
			],
			"categoryPathSegments": [
				{
					"path": "Music",
					"text": "Music",
					"isLast": true
				}
			],
			"title": "Last.fm Now Playing",
			"version": "v1.0",
			"author": "Eric Stiens",
			"authors": [
				{
					"name": "Eric Stiens",
					"githubUsername": "estiens",
					"imageURL": "https://avatars.githubusercontent.com/u/4022668?v=4",
					"bio": "code for good. code for change. code as a medium for magic. code for fun.",
					"primary": true
				}
			],
			"desc": "Displays currently playing song from Last.fm (or scrobbles)",
			"imageURL": "https://s3.amazonaws.com/f.cl.ly/items/400E102E353y3U1x2r2U/Screen%20Shot%202016-02-09%20at%2012.19.47%20PM.png?v=36addc99",
			"dependencies": [
				"ruby",
				"xml-simple"
			],
			"aboutURL": "",
			"lastUpdated": "2021-03-08T15:21:57.113921Z",
			"vars": null
		}
	]
}