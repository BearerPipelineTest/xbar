{
	"person": {
		"name": "Jonathan Keith",
		"githubUsername": "joncse",
		"imageURL": "https://avatars.githubusercontent.com/u/1895779?v=4",
		"bio": "",
		"primary": true
	},
	"plugins": [
		{
			"files": [
				{
					"path": "AWS/elb.30s.sh",
					"filename": "elb.30s.sh",
					"content": "#!/bin/bash\n\n# Percentage of healthy EC2 instances behind an ELB\n#   Dropdown with healthy and unhealthy totals\n#\n# by Jonathan Keith (http://github.com/joncse)\n#\n# \u003cbitbar.title\u003eAWS ELB Healthy Percentage\u003c/bitbar.title\u003e\n# \u003cbitbar.version\u003ev1.0\u003c/bitbar.version\u003e\n# \u003cbitbar.author\u003eJonathan Keith\u003c/bitbar.author\u003e\n# \u003cbitbar.author.github\u003ejoncse\u003c/bitbar.author.github\u003e\n# \u003cbitbar.desc\u003eShows the percentage of healthy EC2 instances behind an ELB along with a dropdown to display the healthy and unhealthy totals.\u003c/bitbar.desc\u003e\n# \u003cbitbar.dependencies\u003eawscli\u003c/bitbar.dependencies\u003e\n# \u003cbitbar.image\u003ehttp://i.imgur.com/nQ6LzvZ.png\u003c/bitbar.image\u003e\n#\n# Dependencies: \n#   awscli (https://aws.amazon.com/cli/)\n\nexport PATH=\"/usr/local/bin:/usr/bin:/bin:$PATH\"\n\n## Required Configuration (must provide your own settings here)\n\n# The name of the Elastic Load Balancer\nLOAD_BALANCER=\"\"\n\n# AWS CLI credential profile\nAWS_CLI_PROFILE=\"default\"\n\n## Optional Configuration (not required)\n\n# Prefix label\nMENU_BAR_PREFIX_LABEL=\"ELB: \"\n\n# InService output color (default green)\nIN_SERVICE_COLOR=\"#29cc00\"\n\n# OutOfService output color (default red)\nOUT_SERVICE_COLOR=\"#ff0033\"\n\n## Implementation (changes optional, not required)\n\nif [ -z \"$LOAD_BALANCER\" ]; then\n  echo \"Missing configuration: load balancer name\"\n  exit 1\nfi\n\n# Fetch list of instance health statuses (InService or OutOfService)\nstatus=$(aws --profile $AWS_CLI_PROFILE elb describe-instance-health --load-balancer-name $LOAD_BALANCER --query 'InstanceStates[*].[State]' --output text)\n\n# Total number of lines fetched\ntotal=$(echo \"$status\" | tr ' ' '\\n' | wc -l | xargs)\n\n# Number of lines containing \"In\" (matches InService lines)\nin=$(echo \"$status\" | tr ' ' '\\n' | grep -c In | xargs)\n\n# Number of lines containing \"Out\" (matches OutOfService lines)\nout=$(echo \"$status\" | tr ' ' '\\n' | grep -c Out | xargs)\n\n# Percentage calculation\npercent=$(bc -l \u003c\u003c\u003c \"($in / $total) * 100\" | xargs printf \"%1.0f\")\n\n# Output\necho \"$MENU_BAR_PREFIX_LABEL $percent%\"\necho \"---\"\necho \"In: $in | color=$IN_SERVICE_COLOR\"\necho \"Out: $out | color=$OUT_SERVICE_COLOR\"\n"
				}
			],
			"path": "AWS/elb.30s.sh",
			"filename": "elb.30s.sh",
			"dir": "AWS",
			"docsPlugin": "AWS/elb.30s.sh.html",
			"docsCategory": "AWS.html",
			"pathSegments": [
				"AWS"
			],
			"categoryPathSegments": [
				{
					"path": "AWS",
					"text": "AWS",
					"isLast": true
				}
			],
			"title": "AWS ELB Healthy Percentage",
			"version": "v1.0",
			"author": "Jonathan Keith",
			"authors": [
				{
					"name": "Jonathan Keith",
					"githubUsername": "joncse",
					"imageURL": "https://avatars.githubusercontent.com/u/1895779?v=4",
					"bio": "",
					"primary": true
				}
			],
			"desc": "Shows the percentage of healthy EC2 instances behind an ELB along with a dropdown to display the healthy and unhealthy totals.",
			"imageURL": "http://i.imgur.com/nQ6LzvZ.png",
			"dependencies": [
				"awscli"
			],
			"aboutURL": "",
			"lastUpdated": "2021-03-08T15:21:44.379934Z",
			"vars": null
		}
	]
}