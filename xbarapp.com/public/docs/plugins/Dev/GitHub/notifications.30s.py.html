
<!doctype html>
<html lang='en' style='background: #111;'>
	<head>
		<meta charset='utf-8' />
		<meta name='viewport' content='width=device-width' />
		<meta http-equiv='X-UA-Compatible' content='ie=edge'>
		<title>GitHub Notifications in your macOS menu bar</title>
		<link rel='stylesheet' href='/public/css/xbar.css?cb=08%20Mar%2021%2015%3a22%20GMT'>
		<link rel='preconnect' href='https://fonts.gstatic.com'>
		<link rel='preconnect' href='https://fonts.googleapis.com'>
		<link rel='stylesheet' href='https://fonts.googleapis.com/css2?family=Bodoni+Moda:wght@500&display=swap'>
		
	<meta name='description' content='GitHub (and GitHub:Enterprise) notifications in your menu bar! - install xbar for free to get started.'>
	<meta name='author' content='Matt Sephton,  Keith Cirkel,  John Flesch'>
	<meta name='keywords' content='macos,menubar,xbar,bitbar'>
	<meta itemprop='image' content='https://i.imgur.com/hW7dw9E.png'>
	<meta itemprop='name' content='GitHub Notifications in your macOS menu bar'>
	<meta itemprop='description' content='GitHub (and GitHub:Enterprise) notifications in your menu bar! - install xbar for free to get started.'>
	<meta name='twitter:card' content='summary_large_image'>
	<meta name='twitter:title' content='GitHub Notifications in your macOS menu bar'>
	<meta name='twitter:description' content='GitHub (and GitHub:Enterprise) notifications in your menu bar! - install xbar for free to get started.'>
	<meta name='twitter:image' content='https://i.imgur.com/hW7dw9E.png'>
	<meta name='twitter:creator' content='matryer'>
	<meta property='og:title' content='GitHub Notifications in your macOS menu bar'>
	<meta property='og:description' content='GitHub (and GitHub:Enterprise) notifications in your menu bar! - install xbar for free to get started.'>
	<meta property='og:url' content='https://xbarapp.com/plugins/Dev/GitHub/notifications.30s.py.html'>
	<meta property='og:site_name' content='xbar lets you put anything into your macOS menu bar'>
	<meta property='og:type' content='article'>
	<meta property='og:image' content='https://i.imgur.com/hW7dw9E.png'>
	<link rel='apple-touch-icon' sizes='180x180' href='https://i.imgur.com/hW7dw9E.png'>
	<link rel='icon' type='image/png' sizes='32x32' href='https://i.imgur.com/hW7dw9E.png'>
	<link rel='shortcut icon' href='https://i.imgur.com/hW7dw9E.png'>
	<meta name='msapplication-TileColor' content='#ffffff'>
	<meta name='msapplication-config' content='/public/browserconfig.xml'>
	<meta name='theme-color' content='#ffffff'>
	<style>
		.code-background {
			background: rgb(255,255,255);
			background: linear-gradient(to right, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0.1) 100%);
		}
		.plugin-app-link {
			margin-left: -32px;
		}
	</style>

	</head>
	<body>
		<header class='flex flex-col'>
			<div class='container mx-auto'>
				<div class='flex items-center space-x-8 p-8 text-white'>
					<a href='/' class='inline-block py-2 text-2xl flex items-center space-x-2 font-bold'>
						<img alt='xbar logo: a circle with three dots inside it' src='/public/img/xbar-2048.png' style='width:48px;height:48px;' />
						<span>xbar</span>
					</a>
					<div class='flex-grow'></div>
					<div>
						<a 
							target='github'
							href='https://github.com/sponsors/matryer' 
							class='text-white px-4 py-2 whitespace-nowrap'
						><span class='mr-1'>ðŸ’œ</span> Sponsor</a>
					</div>
					<div class='hidden md:block'>
						<a 
							target='github'
							href='/dl' 
							class='rounded bg-white text-gray-800 hover:text-black px-4 py-2 shadow hover:shadow-lg whitespace-nowrap'
						>Coming soon</a>
					</div>
				</div>
			</div>
		</header>
		<div id='menubar' class='text-white whitespace-nowrap overflow-hidden flex flex-wrap justify-end items-center text-right'>
			
			
				<a 
					
					href='/docs/plugins/AWS.html'
				>
					AWS
				</a>
			
				<a 
					
					href='/docs/plugins/Cryptocurrency.html'
				>
					Cryptocurrency
				</a>
			
				<a 
					 class='rounded selected' 
					href='/docs/plugins/Dev.html'
				>
					Dev
				</a>
			
				<a 
					
					href='/docs/plugins/E-Commerce.html'
				>
					E-Commerce
				</a>
			
				<a 
					
					href='/docs/plugins/Email.html'
				>
					Email
				</a>
			
				<a 
					
					href='/docs/plugins/Environment.html'
				>
					Environment
				</a>
			
				<a 
					
					href='/docs/plugins/Finance.html'
				>
					Finance
				</a>
			
				<a 
					
					href='/docs/plugins/Games.html'
				>
					Games
				</a>
			
				<a 
					
					href='/docs/plugins/IoT.html'
				>
					IoT
				</a>
			
				<a 
					
					href='/docs/plugins/Lifestyle.html'
				>
					Lifestyle
				</a>
			
				<a 
					
					href='/docs/plugins/Music.html'
				>
					Music
				</a>
			
				<a 
					
					href='/docs/plugins/Network.html'
				>
					Network
				</a>
			
				<a 
					
					href='/docs/plugins/Politics.html'
				>
					Politics
				</a>
			
				<a 
					
					href='/docs/plugins/Science.html'
				>
					Science
				</a>
			
				<a 
					
					href='/docs/plugins/Sports.html'
				>
					Sports
				</a>
			
				<a 
					
					href='/docs/plugins/System.html'
				>
					System
				</a>
			
				<a 
					
					href='/docs/plugins/Time.html'
				>
					Time
				</a>
			
				<a 
					
					href='/docs/plugins/Tools.html'
				>
					Tools
				</a>
			
				<a 
					
					href='/docs/plugins/Travel.html'
				>
					Travel
				</a>
			
				<a 
					
					href='/docs/plugins/Weather.html'
				>
					Weather
				</a>
			
				<a 
					
					href='/docs/plugins/Web.html'
				>
					Web
				</a>
			
		</div>
		
	<div class='container mx-auto flex flex-wrap space-x-8 justify-start items-start mt-16'>
		<div class='flex flex-col justify-start'>
			<div class='px-8 py-2 max-w-3xl'>
				<h1 class='fancy-font text-white text-6xl'>GitHub Notifications</h1>
			</div>
			<div class='p-8 text-sm'>
				
					
						
							<div class='flex space-x-4 pb-8'>
								<div class='tiny-photo'>
									<a 
										href='/docs/contributors/flesch.html'
									>
										<img class='rounded shadow primary' src='https://avatars.githubusercontent.com/u/13259?v=4'>
									</a>
								</div>
								<div>
									<a 
										href='/docs/contributors/flesch.html'
										class='light-background rounded-sm shadow-md px-4 py-2 text-white' 
										style='text-decoration: none;'
									>
										John Flesch (<code style='color:white;'>@flesch</code> on GitHub)
									</a>
								</div>
							</div>
						
					
				
					
						
							<p class='text-white'>
								and <strong>Keith Cirkel</strong>
							</p>
						
					
				
					
						
							<p class='text-white'>
								and <strong>John Flesch</strong>
							</p>
						
					
				
				
					<p class='my-8 text-white opacity-75 text-lg max-w-lg'>
						GitHub (and GitHub:Enterprise) notifications in your menu bar!
					</p>
				
				<div class='plugin-app-link hidden md:flex items-end p-8 m-8 mb-16 bg-black bg-opacity-25 rounded-lg shadow max-w-md'>
					<div>
						<a 
							href='xbar://app.xbarapp.com/openPlugin?path=Dev%2fGitHub%2fnotifications.30s.py'
							class='rounded bg-white text-gray-800 hover:text-black px-4 py-2 shadow hover:shadow-lg whitespace-nowrap'
						><span class='mr-1'>ðŸ–¥</span> Open in xbar app</a>
					</div>
					<div class='opacity-50 text-sm text-white ml-3'>Requires <a target='github' href='/dl' class='underline'>xbar app</a></div>
				</div>
				
			</div>
		</div>
		<div 
			class='flex flex-col justify-center mb-16'
		>
			<img 
				class='max-w-md w-full'
				src='https://i.imgur.com/hW7dw9E.png' 
				alt='Image preview of GitHub Notifications plugin.'
				onerror='this.onerror=null;this.src="/public/img/xbar-2048.png";'
			/>
		</div>
	</div>

	
		<div class='code-background text-white p-8 pb-24'>
			<div class='container mx-auto'>
				<div class='flex flex-wrap py-8 space-x-4 justify-end'>
					<div>
						<h2 class='md:text-2xl text-bold'>
							<code>notifications.30s.py</code>
						</h2>
					</div>
					<div class='flex-grow'></div>
					<div>
						<a class='text-sm text-white hover:text-black hover:bg-white px-4 py-2 rounded' target='github' href='https://github.com/matryer/bitbar-plugins/edit/master/Dev/GitHub/notifications.30s.py'>Edit</a>
					</div>
					<div>
						<a class='text-sm text-gray-700 bg-white hover:bg-gray-100 active:text-black px-4 py-2 rounded' target='github' href='https://github.com/matryer/bitbar-plugins/blob/master/Dev/GitHub/notifications.30s.py'>Open on GitHub</a>
					</div>
				</div>
				<div>
					<pre class='text-sm whitespace-pre-wrap'><code class='break-all '>#!/usr/bin/env python
# -*- coding: utf-8 -*-

# &lt;bitbar.title&gt;GitHub Notifications&lt;/bitbar.title&gt;
# &lt;bitbar.version&gt;v3.0.2&lt;/bitbar.version&gt;
# &lt;bitbar.author&gt;Matt Sephton, Keith Cirkel, John Flesch&lt;/bitbar.author&gt;
# &lt;bitbar.author.github&gt;flesch&lt;/bitbar.author.github&gt;
# &lt;bitbar.desc&gt;GitHub (and GitHub:Enterprise) notifications in your menu bar!&lt;/bitbar.desc&gt;
# &lt;bitbar.image&gt;https://i.imgur.com/hW7dw9E.png&lt;/bitbar.image&gt;
# &lt;bitbar.dependencies&gt;python&lt;/bitbar.dependencies&gt;

import json
import urllib2
import os
import sys
import re
from itertools import groupby

# GitHub.com
github_api_key = os.getenv( &#39;GITHUB_TOKEN&#39;, &#39;Enter your GitHub.com Personal Access Token here...&#39; )

# GitHub:Enterprise (optional)
enterprise_api_key = os.getenv( &#39;GITHUB_ENTERPRISE_TOKEN&#39;, &#39;Enter your GitHub:Enterprise Personal Access Token here...&#39; )
enterprise_api_url = os.getenv( &#39;GITHUB_ENTERPRISE_API&#39;, &#39;https://github.example.com/api/v3&#39; )

active = &#39;#4078C0&#39;
inactive = &#39;#7d7d7d&#39;

# Utility Functions

def plural( word, n ):
    return str(n) &#43; &#39; &#39; &#43; (word &#43; &#39;s&#39; if n &gt; 1 else word)

def get_dict_subset( thedict, *keys ):
    return dict([ (key, thedict[key]) for key in keys if key in thedict ])

def print_bitbar_line( title, **kwargs ):
    print title &#43; &#39; | &#39; &#43; ( &#39; &#39;.join( [ &#39;{}={}&#39;.format( k, v ) for k, v in kwargs.items() ] ) )

def make_github_request( url, method=&#39;GET&#39;, data=None, enterprise = False ):
    try:
        api_key = enterprise_api_key if enterprise else github_api_key
        headers = {
            &#39;Authorization&#39;: &#39;token &#39; &#43; api_key,
            &#39;Accept&#39;: &#39;application/json&#39;,
        }
        if data is not None:
            data = json.dumps(data)
            headers[&#39;Content-Type&#39;] = &#39;application/json&#39;
            headers[&#39;Contnet-Length&#39;] = len(data)
        request = urllib2.Request( url, headers=headers )
        request.get_method = lambda: method
        response = urllib2.urlopen( request, data )
        return json.load( response ) if response.headers.get(&#39;content-length&#39;, 0) &gt; 0 else {}
    except Exception:
        return None

def get_notifications( enterprise ):
    url = &#39;%s/notifications&#39; % (enterprise_api_url if enterprise else &#39;https://api.github.com&#39;)
    return make_github_request( url, enterprise=enterprise ) or []

def print_notifications( notifications, enterprise=False ):
    notifications = sorted( notifications, key=lambda notification: notification[&#39;repository&#39;][&#39;full_name&#39;] )
    for repo, repo_notifications in groupby( notifications, key=lambda notification: notification[&#39;repository&#39;][&#39;full_name&#39;] ):
        if repo:
            repo_notifications = list( repo_notifications )
            print_bitbar_line( title=repo )
            print_bitbar_line(
                title=&#39;{title} - Mark {count} As Read&#39;.format( title=repo, count=len( repo_notifications ) ),
                alternate=&#39;true&#39;,
                refresh=&#39;true&#39;,
                bash=__file__,
                terminal=&#39;false&#39;,
                param1=&#39;readrepo&#39;,
                param2=repo,
                param3=&#39;--enterprise&#39; if enterprise else None
            )
            for notification in repo_notifications:
                formatted_notification = format_notification( notification )
                print_bitbar_line( refresh=&#39;true&#39;, **get_dict_subset( formatted_notification, &#39;title&#39;, &#39;href&#39;, &#39;image&#39;, &#39;templateImage&#39; ) )
                print_bitbar_line(
                    refresh=&#39;true&#39;,
                    title=&#39;%s - Mark As Read&#39; % formatted_notification[&#39;title&#39;],
                    alternate=&#39;true&#39;,
                    bash=__file__,
                    terminal=&#39;false&#39;,
                    param1=&#39;readthread&#39;,
                    param2=formatted_notification[&#39;thread&#39;],
                    param3=&#39;--enterprise&#39; if enterprise else None,
                    **get_dict_subset( formatted_notification, &#39;image&#39;, &#39;templateImage&#39; )
                )

def format_notification( notification ):
    type = notification[&#39;subject&#39;][&#39;type&#39;]
    formatted = {
        &#39;thread&#39;: notification[&#39;url&#39;],
        &#39;title&#39;: notification[&#39;subject&#39;][&#39;title&#39;].encode(&#39;utf-8&#39;),
        &#39;href&#39;: notification[&#39;subject&#39;][&#39;url&#39;],
        &#39;image&#39;: &#39;iVBORw0KGgoAAAANSUhEUgAAAA4AAAAQCAYAAAAmlE46AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAA&#39;,
    }
    if len(formatted[&#39;title&#39;]) &gt; 90:
        formatted[&#39;title&#39;] = formatted[&#39;title&#39;][:79] &#43; &#39;â€¦&#39;
    formatted[&#39;title&#39;] = formatted[&#39;title&#39;].replace(&#39;|&#39;,&#39;-&#39;)
    latest_comment_url = notification.get( &#39;subject&#39;, {} ).get( &#39;latest_comment_url&#39;, None )
    typejson = make_github_request( formatted[&#39;href&#39;] )
    if latest_comment_url:
        formatted[&#39;href&#39;] = ( make_github_request( latest_comment_url ) or {} ).get( &#39;html_url&#39;, formatted[&#39;href&#39;] )
    # Try to hack a web-viewable URL if the last check failed
    if formatted[&#39;href&#39;]:
        formatted[&#39;href&#39;] = re.sub( &#39;api\.|api/v3/|repos/&#39;, &#39;&#39;, re.sub( &#39;(pull|commit)s&#39;, ur&#39;\1&#39;, formatted[&#39;href&#39;] ) )
    if (type == &#39;PullRequest&#39;):
        if typejson and typejson[&#39;merged&#39;]:
            formatted[&#39;image&#39;] &#43;= &#39;SpJREFUKJG9kkFOwmAQhb&#43;ZQiVx5xm4hIlncEF7jLZuWSjSeAJsvQUY4xkMHsCtcU9MXBmwJsy4EWgFEt34VpP55mX&#43;eflhj9KoGO5jAK00LmOwoZiaYIPRbXaXRsVQRC6BvWZJ4uLJRI6DcKlUMsVl/G0CwIw3UR8V4&#43;QKxFd9BbfDqiP6buo1sB5QjgTJ07i8aPTFgvNFa/7i7fYzaL&#43;YpEN3zwGux4mY2QmAm6db783i0rO4bGyrh7OL66a0Bigm6d5gGkYz3brvV8a/SjeF/dPGJLrpmTMDXs/i4vTnQNYrInNm5szqvIVYbiJdCV1Z6ANwXze6em4i3SBcqi&#43;CNVeAIFxq9dkR0&#43;07HfHVz6rzlsLAK5keUCEu/R0hDD7C&#43;SME6A7&#43;Z30BqF2G&#43;GPLjSUAAAAASUVORK5CYII=&#39;
        elif typejson and typejson[&#39;state&#39;] == &#39;closed&#39;:
            formatted[&#39;image&#39;] &#43;= &#39;Q9JREFUKJG9kjFOw0AQRd9sbAiiQOIMqWJfAInOPULANehTQIjFCbgHFS1eKhR6cDpEbyHRmljyDpWVTWJbSsOvRvvm72i&#43;BjpkI2ZdDIBszNVzTG7HvGcx543JxmifT7KIj4FyUlaYcMjcKI8Id17Pj8JDknMvrD4zoriwRg4OMaKtU44FUhtz6z8aFW7KkC9X82mESbJghpICJDkiyimAwvV2EDG6uZMfThs3TeFYB8miP1XjFb0pdhp31cro/muijbjAUTjDtx1zttnwEnGJo8BR&#43;DxQSAcwWv5i9vd4BZ58Yy2kgTIqq3VuAMoKEx4htCQrijaX5fMAYRoOmbMEJ0y2lhGmZcgbNdDGd9Uf3M1iNlKZZGMAAAAASUVORK5CYII=&#39;
        else:
            formatted[&#39;image&#39;] &#43;= &#39;TJJREFUKJG9krFOAlEQRe/MLpqHnd/ATyBWsLWF&#43;hcLPYXibvwCE/gLC2MNVrD7AbbGnpjYboBlro2QXWATabzVy5x338ydPKBC4awTVTEA8Huz9i1FI5gZBINh6&#43;0lnHUiEXkAUGmWMGm/c7Fues4pLU9IPv&#43;aAABm9i2qT6Pm&#43;BECbuoqpnZWW4lmmRLG3ZdV9VyAOEyD&#43;1JdVO4yqX&#43;ua7UPofRHrUlEMgaA4cVYALkEACF6e/N2k4DdJCh1Ky7nENftyVACo9akcjElox3I9yfjsdoaVfFPHbtpcG2GOUy/wjS42r0QTjs3ZpibYV7kPmkxVuuGOKfIl1MAr0WjqMRcrBqec8oCVwDwnNOFnwugezkJ4&#43;ZnFbkPeANanpwsAQr7&#43;2m8Qab1FKcAeYgfqR/3P4pMOYR15QAAAABJRU5ErkJggg==&#39;
        if typejson and typejson.get( &#39;user&#39;, {} ).get( &#39;login&#39;, None ):
            formatted[&#39;title&#39;] &#43;= &#39; (by @{})&#39;.format(typejson[&#39;user&#39;][&#39;login&#39;])
    elif (type == &#39;RepositoryInvitation&#39;):
        formatted[&#39;image&#39;] = &#39;iVBORw0KGgoAAAANSUhEUgAAAA4AAAAKCAYAAACE2W/HAAAAAXNSR0IArs4c6QAAAM1JREFUKBWVkD0OQUEUhcdv/ASJn55SyxLoVBJq8tZjBRQsgkZiAQoqOiQ2oFc935nMvLxEXsRJPufOufe&#43;kTHGmBeEf3Jg3i4t8IwOP6QZzeoi&#43;3PFt1BRkKAq&#43;Q4uEKbdUA&#43;/wxm6LoubshPcoO8b9lp3GOMPGPomPoInqOcV/VUfyKfwhsChegJxfS3O6R5hALpFqFY2A69osUyygT3UQOpAWwVSpt4aShAt6lWXkIUk5WiswL5qiqIODdBz6&#43;ZirM67cwFvulwfaH0AC7M1lHL62U4AAAAASUVORK5CYII=&#39;;
        formatted[&#39;templateImage&#39;] = formatted.pop(&#39;image&#39;);
        formatted[&#39;href&#39;] = &#39;https://github.com/{}/invitations&#39;.format(notification[&#39;repository&#39;][&#39;full_name&#39;])
    elif (type == &#39;Issue&#39;):
        if typejson and typejson[&#39;state&#39;] == &#39;closed&#39;:
            formatted[&#39;image&#39;] &#43;= &#39;YpJREFUKJGdkj9I23EQxT93SZrJQYNQ6Bo65BtQcHRpSeyUuQqNWx2ti7qJRpqhUxGX0lGhlXQ0uJhfU7cOLm3&#43;QKCzoIjoJpp8z0HT/BpJBd90HO/dvTsePBLS36iM8Uw6vANyQNJ7RJU/wG7nmo1XLY7uCStp8uL5BJwgbJtRU8E8jImR98qoGHPZBjsSFhlsCRQjCQovD2iHhx5OEDu/ZF2E5Y4wLn/tXdMy5WO2zkqXHKQxgEy95&#43;y7Y1KMXwogbeaBk0iCwqBn7DteAJym&#43;NmBnSiAF3IK2/32wiIVqoGjYE1GRMlGARSSZtQGbZtq8CNwFBBWDUxgJjqI3I9Mg7XAgRoXmSYlACqOWuAG39ePimNB7&#43;oyxuzhBLEwIUhj3c92sZckLsaSAvg2m14ZPb98eGs8ThFlqBcAx4wJX8T4cGasvm5yFRaUUjwZUd4bLKow/W/kbsWfgTMxvorxmwhtjHEPbxSGEd5many7F/JqiqdemceT88rzu3ZLoWywma1z/NA5/8UNNkSJCdaYQF4AAAAASUVORK5CYII=&#39;
        else:
            formatted[&#39;image&#39;] &#43;= &#39;ZxJREFUKJGdkjFoU2EUhb97k9jNRzEFoWvJVHXoZCqIaQaH7JaUbtpi2zc4ORWJYKGTYJLBroFaiGPo0hBwyAOhU51Cd8EOOid53uugL4SnkOK3/dx7OPccfvhPZPqxHZUWc0gIUjFs6c/CJdDBtN580P36lzCM1jZ&#43;mr9HuFKkJfgXABO9i/mmqOTd7VlztXcyEYbR2oabtFx5kx&#43;Oa7VHn&#43;LpS7bOV3K5UfBaTF&#43;6WLW52juR7ai0mDEGovq2WezuJ8t7UdkBGsXu5KqdfvlQhOeeGRc0h4QIV/nhuDarkIVgft&#43;xHxJnQwWpKNJKn/cvasvtkcCxuFTUsKWkiOsgrhcoBb2uIE1W4NKRO8DH6cF0KSnLewYDBTqGb26dr&#43;Sm53tR2ZNmE8LTx3O4V9XpKKZ1FV24MZyf2aoH8YE5garXBWC3X1oX12NXO8zfvPWqttwepZ08iA9wXqDypFE8a09y7PZL64geCXx37IO4XiSZcK/&#43;dso8bRTP2pD65DufH96WOBuKSwWlAGD4QJ2Oqtff3e99mxVnJr8AXSGi02ni0&#43;YAAAAASUVORK5CYII=&#39;
    elif (type == &#39;Commit&#39;):
        formatted[&#39;image&#39;] &#43;= &#39;HhJREFUKJHl0LEKwkAQBNCH3yIaf05S&#43;VUqmh8ykFoUYn8WbnEc8a7XgYVlmNkdhv/EDgNmvHDFtmXq8ETCiFvsD2xqxksI9xnXB3cqxamYceHgVOpWC6JUi/QNQxj7jDsEd6wZ83KmLOId69bXzqekOeas0eiv4g3q4SY7NY1R2gAAAABJRU5ErkJggg==&#39;
        formatted[&#39;templateImage&#39;] = formatted.pop(&#39;image&#39;)
    elif (type == &#39;Release&#39;):
        formatted[&#39;image&#39;] &#43;= &#39;JdJREFUKJGl0DsKwkAUBdDTRgvFHbgmNyLY&#43;QWzKxM/kK2kSKc70MIIQ0ziqBceA/dxinn8mSkKVMGUmH&#43;CBWaNboQjdn2wqt97Pa8kNd5&#43;C0O86YNdSZC34RLjCJxhHZYLXDCIxKuwTHGOwBNcm2WKUw9OcMCybZl6XjHpQOs30cB5gKNQiDPPP0WjV/a4aVwxNsNfUGce7P8k4XgVPSYAAAAASUVORK5CYII=&#39;
        formatted[&#39;templateImage&#39;] = formatted.pop(&#39;image&#39;)
    return formatted

if len(sys.argv) &gt; 1:
    command = sys.argv[1]
    args = sys.argv[2:]
    enterprise=False
    if (&#39;--enterprise&#39; in args):
        enterprise=True
        args.remove( &#39;--enterprise&#39; )
    if command == &#39;readrepo&#39;:
        url = &#39;%s/repos/%s/notifications&#39; % (enterprise_api_url if enterprise else &#39;https://api.github.com&#39;, args[0])
        print &#39;Marking %s as read&#39; % url
        make_github_request( url=url, method=&#39;PUT&#39;, data={}, enterprise=enterprise )
    elif command == &#39;readthread&#39;:
        url = args[0]
        print &#39;Marking %s as read&#39; % url
        make_github_request( url=url, method=&#39;PATCH&#39;, data={}, enterprise=enterprise )

else:
    is_github_defined = len( github_api_key ) == 40
    is_github_enterprise_defined = len( enterprise_api_key ) == 40
    github_notifications = get_notifications( enterprise=False ) if is_github_defined else []
    enterprise_notifications = get_notifications( enterprise=True ) if is_github_enterprise_defined else []
    has_notifications = len( github_notifications ) &#43; len( enterprise_notifications )
    color = active if has_notifications else inactive

    if (has_notifications):
        print_bitbar_line(
            title=u&#39;\u25CF&#39;.encode( &#39;utf-8&#39; ),
            color=color
        )
        print &#39;---&#39;
    else:
        print &#39;&#39;
        exit(0)

    print_bitbar_line( title=&#39;Refresh&#39;, refresh=&#39;true&#39; )

    if is_github_defined:
        if len( github_notifications ):
            print_bitbar_line(
                title=( u&#39;GitHub \u2014 %s&#39; % plural( &#39;notification&#39;, len( github_notifications ) ) ).encode( &#39;utf-8&#39; ),
                color=active,
                href=&#39;https://github.com/notifications&#39;,
            )
            print_notifications( github_notifications )
        else:
            print_bitbar_line(
                title=u&#39;GitHub \u2014 No new notifications&#39;.encode( &#39;utf-8&#39; ),
                color=inactive,
                href=&#39;https://github.com&#39;,
            )

    if is_github_enterprise_defined:
        if len( enterprise_notifications ):
            if is_github_defined:
                print &#39;---&#39;
            print_bitbar_line(
                title=( u&#39;GitHub:Enterprise \u2014 %s&#39; % plural( &#39;notification&#39;, len( enterprise_notifications ) ) ).encode( &#39;utf-8&#39; ),
                color=active,
                href=&#39;%s/notifications&#39; % re.sub( &#39;/api/v3&#39;, &#39;&#39;,  enterprise_api_url ),
            )
            print_notifications( enterprise_notifications, enterprise=True )
        else:
            print &#39;---&#39;
            print_bitbar_line(
                title=u&#39;GitHub:Enterprise \u2014 No new notifications&#39;,
                color=inactive,
            )
</code></pre>
				</div>
			</div>
		</div>
	

		<footer class='container mx-auto text-white text-lg opacity-75 mt-8'>
			<div class='text-center p-16'>
				<p>
					<div>
						<a target='github' class='underline hover:text-white' href='https://github.com/matryer/xbar'>GitHub project</a>
						â€¢
						<a target='github' class='underline hover:text-white' href='https://github.com/matryer/xbar#writing-plugins'>Writing plugins guide</a>
					</div>
					<div class='mt-8'>
						Copyright &copy;2021 Mat Ryer + contributors â€¢ <a target='twitter' class='underline hover:text-white' href='https://twitter.com/matryer'>@matryer</a>
					</div>
					<div class='opacity-50 mt-2'>
						Last updated on 08 Mar 21 15:22 GMT
					</div>
				</p>
			</div>
		</footer>
	</body>
</html>
