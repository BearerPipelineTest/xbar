{
	"plugin": {
		"files": [
			{
				"path": "Email/gmail-checker-improved.1m.pl",
				"filename": "gmail-checker-improved.1m.pl",
				"content": "#!/usr/bin/perl -w\n# \u003cbitbar.title\u003eGmail Checker Improved\u003c/bitbar.title\u003e\n# \u003cbitbar.version\u003ev1.0\u003c/bitbar.version\u003e\n# \u003cbitbar.author.github\u003eaxeloz\u003c/bitbar.author.github\u003e\n# \u003cbitbar.author\u003eAxel\u003c/bitbar.author\u003e\n# \u003cbitbar.desc\u003eGmail unread emails checker.\u003c/bitbar.desc\u003e\n# \u003cbitbar.dependencies\u003eperl,gmail\u003c/bitbar.dependencies\u003e\n# \u003cbitbar.image\u003ehttps://i.imgur.com/gYYJB7U.png\u003c/bitbar.image\u003e\n\nuse strict;\nuse LWP::Simple;\nuse LWP::UserAgent;\nuse Mozilla::CA;\nuse XML::Simple;\nuse Encode;\nuse POSIX;\n\nmy $url = 'https://mail.google.com/mail/feed/atom';\nmy $user = '\u003cusername\u003e';\nmy $password = '\u003cpassword\u003e';\nmy $output;\n\nmy $ua = LWP::UserAgent-\u003enew;\n$ua-\u003ecredentials('mail.google.com:443', 'mail.google.com', $user, $password);\n\nmy $content = $ua-\u003eget($url);\ndie \"Couldn't get $url\" unless defined $content;\n\nsub clevercut {\n\tmy ($txt, $max) = @_;\n\t\n\tif (length($txt) \u003e $max) {\n\t\treturn (substr $txt, 0, $max ).' [...]';\n\t}\n\treturn $txt;\n}\n\n\nif ($content-\u003estatus_line eq '200 OK') {\n\tmy $xs = XML::Simple-\u003enew();\n\tmy $ref = XMLin($content-\u003econtent, ForceArray=\u003e'entry');\n\n\tif ($ref-\u003e{fullcount}-\u003e[0] \u003e 0) {\n\t\t$output .= \"ðŸ“¬ \".$ref-\u003e{fullcount}-\u003e[0].\"\\n\";\n\t\t$output .= \"---\\n\";\n\t\t\n\t\tif ($ref-\u003e{fullcount}-\u003e[0] == 1) {\n\t\t\t$output .= \"You have 1 new message | size=16 \\n\";\n\t\t}\n\t\telse {\n\t\t\t$output .= \"You have \".$ref-\u003e{fullcount}-\u003e[0].\" new messages | size=16 \\n\";\n\t\t}\n\t\t$output .= \"  | size=14 color=black \\n\";\n\t\t\n\t\tforeach my $email (@{ $ref-\u003e{entry} }) {\n\t\t\t$output .= \"Â» \".clevercut(encode(\"utf8\", $email-\u003e{title}-\u003e[0]), 30).\" | href=\".$email-\u003e{link}-\u003e[0]-\u003e{href}.\"\\n\";\n\t\t}\n\t\t\n\t}\n\telse {\n\t\t$output .= \"ðŸ“ª\\n\";\n\t\t$output .= \"---\\n\";\n\t\t$output .= \"No new message | size=16 \\n\";\n\t}\n}\n$output .= \"---\\n\";\n$output .= \"âž¤ Open Mailbox |href=https://www.gmail.com\\n\";\nprint $output.\"\\n\";\n"
			}
		],
		"path": "Email/gmail-checker-improved.1m.pl",
		"filename": "gmail-checker-improved.1m.pl",
		"dir": "Email",
		"docsPlugin": "Email/gmail-checker-improved.1m.pl.html",
		"docsCategory": "Email.html",
		"pathSegments": [
			"Email"
		],
		"categoryPathSegments": [
			{
				"path": "Email",
				"text": "Email",
				"isLast": true
			}
		],
		"title": "Gmail Checker Improved",
		"version": "v1.0",
		"author": "Axel",
		"authors": [
			{
				"name": "Axel",
				"githubUsername": "axeloz",
				"imageURL": "https://avatars.githubusercontent.com/u/1597611?v=4",
				"bio": "",
				"primary": true
			}
		],
		"desc": "Gmail unread emails checker.",
		"imageURL": "https://i.imgur.com/gYYJB7U.png",
		"dependencies": [
			"perl",
			"gmail"
		],
		"aboutURL": "",
		"lastUpdated": "2021-03-08T15:21:52.824909Z",
		"vars": null
	}
}