{
	"plugin": {
		"files": [
			{
				"path": "Lifestyle/Trello/trello_board.30s.py",
				"filename": "trello_board.30s.py",
				"content": "#!/usr/bin/python\n\n# \u003cbitbar.title\u003etrello list\u003c/bitbar.title\u003e\n# \u003cbitbar.version\u003ev1.0\u003c/bitbar.version\u003e\n# \u003cbitbar.author\u003eKarim Boumedhel\u003c/bitbar.author\u003e\n# \u003cbitbar.author.github\u003ekarmab\u003c/bitbar.author.github\u003e\n# \u003cbitbar.desc\u003eLists trello cards in New/In Progress\u003c/bitbar.desc\u003e\n\n\nimport os\nimport requests\nimport sys\n\nkey = os.environ['TRELLO_KEY'] if 'TRELLO_KEY' in os.environ else None\ntoken = os.environ['TRELLO_TOKEN'] if 'TRELLO_TOKEN' in os.environ else None\nboard = os.environ['TRELLO_BOARD'] if 'TRELLO_BOARD' in os.environ else None\nboardname = os.environ['TRELLO_BOARDNAME'] if 'TRELLO_BOARDNAME' in os.environ else None\nstates = os.environ['TRELLO_STATES'] if 'TRELLO_STATES' in os.environ else 'Next,In Progress'\nuser = os.environ['TRELLO_USER'] if 'TRELLO_USER' in os.environ else None\n\nstates = states.split(',')\nerror = None\nif key is None:\n    error = \"Missing key\\nGet it at https://trello.com/app-key\"\nif token is None:\n    error = \"Missing token\\nGet it at https://trello.com/app-key\"\nif boardname is None and board is None:\n    error = \"Missing board information\\nDefine board short or long name\"\nif user is None:\n    error = \"Missing username\"\n\nif error is not None:\n    warning = u\"\\u26A0\"\n    warning = warning.encode('utf-8')\n    print(\"%s\\n\" % warning)\n    print(\"---\\n\")\n    print(error)\n    sys.exit(1)\n\nboardsurl = \"https://api.trello.com/1/members/%s/boards?key=%s\u0026token=%s\" % (user, key, token)\nr = requests.get(boardsurl)\nif board:\n    board = [b for b in r.json() if b['shortLink'] == board]\n    if board:\n        boardname = board[0]['name']\nelif boardname:\n    board = [b for b in r.json() if b['name'] == boardname]\nif len(board) != 1:\n    print \"Missing board information\"\n    sys.exit(0)\nboardid = board[0]['id']\n\nstatesurl = \"https://api.trello.com/1/boards/%s/lists?key=%s\u0026token=%s\" % (boardid, key, token)\nr = requests.get(statesurl)\nstatesinfo = {}\nfor l in r.json():\n    if l['name'] in states:\n        statesinfo[l['id']] = l['name']\n\ncardsurl = \"https://api.trello.com/1/members/%s/cards?key=%s\u0026token=%s\" % (user, key, token)\nr = requests.get(cardsurl)\ncards = [card for card in r.json() if card['idBoard'] == boardid and card['idList'] in statesinfo]\nif cards:\n    print(\"%s Trello cards in %s\" % (len(cards), boardname))\nelse:\n    print(\"No Trello cards in %s\" % boardname)\n    sys.exit(0)\nprint(\"---\\n\")\noldcolumn = None\nfor card in sorted(cards, key=lambda c: (statesinfo[c['idList']], c['name'])):\n    currentcolumn = statesinfo[card['idList']]\n    if oldcolumn is None:\n        oldcolumn = currentcolumn\n        print currentcolumn\n    if currentcolumn != oldcolumn:\n        print(\"---\\n\")\n        print currentcolumn\n    url = card['url']\n    name = card['name']\n    print(\"%s | href=%s\" % (name, url))\n"
			}
		],
		"path": "Lifestyle/Trello/trello_board.30s.py",
		"filename": "trello_board.30s.py",
		"dir": "Lifestyle/Trello",
		"docsPlugin": "Lifestyle/Trello/trello_board.30s.py.html",
		"docsCategory": "Lifestyle/Trello.html",
		"pathSegments": [
			"Lifestyle",
			"Trello"
		],
		"categoryPathSegments": [
			{
				"path": "Lifestyle",
				"text": "Lifestyle",
				"isLast": false
			},
			{
				"path": "Lifestyle/Trello",
				"text": "Trello",
				"isLast": true
			}
		],
		"title": "trello list",
		"version": "v1.0",
		"author": "Karim Boumedhel",
		"authors": [
			{
				"name": "Karim Boumedhel",
				"githubUsername": "karmab",
				"imageURL": "https://avatars.githubusercontent.com/u/1840387?v=4",
				"bio": "loves python, guitar and his family too",
				"primary": true
			}
		],
		"desc": "Lists trello cards in New/In Progress",
		"imageURL": "https://xbarapp.com/public/img/xbar-2048.png",
		"dependencies": null,
		"aboutURL": "",
		"lastUpdated": "2021-03-08T15:21:54.889425Z",
		"vars": null
	}
}