{
	"plugin": {
		"files": [
			{
				"path": "Sports/F1.1s.py",
				"filename": "F1.1s.py",
				"content": "#!/usr/bin/env python\n\n# \u003cbitbar.title\u003eF1 Countdown\u003c/bitbar.title\u003e\n# \u003cbitbar.version\u003ev1.0\u003c/bitbar.version\u003e\n# \u003cbitbar.author\u003eDE\u003c/bitbar.author\u003e\n# \u003cbitbar.author.github\u003edestroy-everything\u003c/bitbar.author.github\u003e\n# \u003cbitbar.desc\u003eShows countdown to next F1 event normalised to UTC.\u003c/bitbar.desc\u003e\n# \u003cbitbar.image\u003ehttp://i.imgur.com/3232EJx.png\u003c/bitbar.image\u003e\n# \u003cbitbar.dependencies\u003epython\u003c/bitbar.dependencies\u003e\n\n#SETUP INSTRUCTIONS\n# 1:\n#To set up your environment for this you need to download \n#https://github.com/collective/icalendar/archive/3.9.2.zip\n#extract the above then go into the directory and run the following:\n#sudo python setup.py install\n#all other dependencies are core\n# 2:\n#Now we just need to download the calendar file and tell the script where you put it\n#http://www.f1calendar.com/download/f1-calendar_p1_p2_p3_q_gp.ics?t=1461060079\n#Download this file and save it somwhere the script can get to it and the update the below 'calfile' variable with the full path to the file\n#Dont put the cal file in the plugins folder, you can create a sub-directory like I have else you will break all your plugins\n\ncalfile = \"/Users/me/Documents/BitbarPlugins/f1data/f1-calendar_p1_p2_p3_q_gp.ics\"\n\n###################################################\n###################################################\n#### you dont need to change anything past here ###\n###################################################\n###################################################\n\nfrom icalendar import Calendar\n#from datetime import datetime\nfrom datetime import datetime\nfrom pytz import timezone\nimport pytz\nimport re\nimport tzlocal  # $ pip install tzlocal\n\n#import urllib2\n#import requests\n#GOD DAM OSX ships with old version of py cant get to HTTPS services without breaking\n\n#DATE = '2016-04-29 18:30:00'\nnow = datetime.utcnow()\n#calfile = requests.get('http://www.f1calendar.com/download/f1-calendar_p1_p2_p3_q_gp.ics?t=1461060079')\n#calfile = urllib2.urlopen(\"http://www.f1calendar.com/download/f1-calendar_p1_p2_p3_q_gp.ics?t=1461060079\")\n#with open('/Users/C5066492/Documents/BitBarPlugins/cal/f1-calendar2016.ics','wb') as output:\n#output.write(calfile.read())\n\nutc=pytz.UTC\n\n\ng = open(calfile,'rb')\ngcal = Calendar.from_ical(g.read())\nfor component in gcal.walk():\n\tif component.name == \"VEVENT\":\n\n\t\t\tif component.get('dtstart').dt \u003e utc.localize(now) :\n\t\t\t\tDATE = component.get('dtstart').dt\n\t\t\t\tsummary = component.get('summary')\n\t\t\t\tlocation = component.get('location')\n\t\t\t\tmatchObjFP1 = re.search( r'First.*Practice.*', summary, re.M|re.I)\n\t\t\t\tmatchObjFP2 = re.search( r'Second.*Practice.*', summary, re.M|re.I)\n\t\t\t\tmatchObjFP3 = re.search( r'Third.*Practice.*', summary, re.M|re.I)\n\t\t\t\tmatchObjQ = re.search( r'Qualifying.*', summary, re.M|re.I)\n\t\t\t\tmatchObjGP = re.search( r'Grand.*Prix.*', summary, re.M|re.I)\n\t\t\t\t\n\t\t\t\tif matchObjFP1:\n\t\t\t\t\t\t#print \"FIRST PRACTICE1 : \", matchObj.group()\n\t\t\t\t\t\tevent = \"FP1:\"\n\n\t\t\t\telif matchObjFP2:\n\t\t\t\t\t\tevent = \"FP2:\"\n\t\t\t\telif matchObjFP3:\n\t\t\t\t\t\tevent = \"FP3:\"\n\t\t\t\telif matchObjQ:\n\t\t\t\t\t\tevent = \"QUALI:\"\n\t\t\t\telif matchObjGP:\n\t\t\t\t\t\tevent = \"GP:\"\n\t\t\t\tbreak\n\ng.close()\n\n\ndef dateDiffInSeconds(date1, date2):\n    timedelta = date2 - date1\n    return timedelta.days * 24 * 3600 + timedelta.seconds\n\n\ndef daysHoursMinutesSecondsFromSeconds(seconds):\n    minutes, seconds = divmod(seconds, 60)\n    hours, minutes = divmod(minutes, 60)\n    days, hours = divmod(hours, 24)\n    #return (days, hours, minutes)\n    return (days, hours, minutes, seconds)\nnow = datetime.now()\nus_tz = timezone(tzlocal.get_localzone().zone)\nlocalized_end_date = us_tz.normalize(DATE.astimezone(us_tz))\nprint event,\"%dd %dh %dm %ds\" % daysHoursMinutesSecondsFromSeconds(dateDiffInSeconds(utc.localize(now), localized_end_date  )), \"|size=12 color=#95949e\"\n#  %ds\nprint \"---\"\nprint \"---\"\nprint summary \nprint location \n"
			}
		],
		"path": "Sports/F1.1s.py",
		"filename": "F1.1s.py",
		"dir": "Sports",
		"docsPlugin": "Sports/F1.1s.py.html",
		"docsCategory": "Sports.html",
		"pathSegments": [
			"Sports"
		],
		"categoryPathSegments": [
			{
				"path": "Sports",
				"text": "Sports",
				"isLast": true
			}
		],
		"title": "F1 Countdown",
		"version": "v1.0",
		"author": "DE",
		"authors": [
			{
				"name": "DE",
				"githubUsername": "destroy-everything",
				"imageURL": "https://avatars.githubusercontent.com/u/12470102?v=4",
				"bio": "",
				"primary": true
			}
		],
		"desc": "Shows countdown to next F1 event normalised to UTC.",
		"imageURL": "http://i.imgur.com/3232EJx.png",
		"dependencies": [
			"python"
		],
		"aboutURL": "",
		"lastUpdated": "2021-03-08T15:22:00.998488Z",
		"vars": null
	}
}