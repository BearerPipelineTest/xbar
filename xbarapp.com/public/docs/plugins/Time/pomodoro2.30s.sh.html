
<!doctype html>
<html lang='en' style='background: #111;'>
	<head>
		<meta charset='utf-8' />
		<meta name='viewport' content='width=device-width' />
		<meta http-equiv='X-UA-Compatible' content='ie=edge'>
		<title>Pomodoro Timer in your macOS menu bar</title>
		<link rel='stylesheet' href='/public/css/xbar.css?cb=08%20Mar%2021%2015%3a22%20GMT'>
		<link rel='preconnect' href='https://fonts.gstatic.com'>
		<link rel='preconnect' href='https://fonts.googleapis.com'>
		<link rel='stylesheet' href='https://fonts.googleapis.com/css2?family=Bodoni+Moda:wght@500&display=swap'>
		
	<meta name='description' content='Timer that uses Pomodoro timeboxing - install xbar for free to get started.'>
	<meta name='author' content='Martin Kourim'>
	<meta name='keywords' content='macos,menubar,xbar,bitbar'>
	<meta itemprop='image' content='https://i.imgur.com/WswKpT4.png'>
	<meta itemprop='name' content='Pomodoro Timer in your macOS menu bar'>
	<meta itemprop='description' content='Timer that uses Pomodoro timeboxing - install xbar for free to get started.'>
	<meta name='twitter:card' content='summary_large_image'>
	<meta name='twitter:title' content='Pomodoro Timer in your macOS menu bar'>
	<meta name='twitter:description' content='Timer that uses Pomodoro timeboxing - install xbar for free to get started.'>
	<meta name='twitter:image' content='https://i.imgur.com/WswKpT4.png'>
	<meta name='twitter:creator' content='matryer'>
	<meta property='og:title' content='Pomodoro Timer in your macOS menu bar'>
	<meta property='og:description' content='Timer that uses Pomodoro timeboxing - install xbar for free to get started.'>
	<meta property='og:url' content='https://xbarapp.com/plugins/Time/pomodoro2.30s.sh.html'>
	<meta property='og:site_name' content='xbar lets you put anything into your macOS menu bar'>
	<meta property='og:type' content='article'>
	<meta property='og:image' content='https://i.imgur.com/WswKpT4.png'>
	<link rel='apple-touch-icon' sizes='180x180' href='https://i.imgur.com/WswKpT4.png'>
	<link rel='icon' type='image/png' sizes='32x32' href='https://i.imgur.com/WswKpT4.png'>
	<link rel='shortcut icon' href='https://i.imgur.com/WswKpT4.png'>
	<meta name='msapplication-TileColor' content='#ffffff'>
	<meta name='msapplication-config' content='/public/browserconfig.xml'>
	<meta name='theme-color' content='#ffffff'>
	<style>
		.code-background {
			background: rgb(255,255,255);
			background: linear-gradient(to right, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0.1) 100%);
		}
		.plugin-app-link {
			margin-left: -32px;
		}
	</style>

	</head>
	<body>
		<header class='flex flex-col'>
			<div class='container mx-auto'>
				<div class='flex items-center space-x-8 p-8 text-white'>
					<a href='/' class='inline-block py-2 text-2xl flex items-center space-x-2 font-bold'>
						<img alt='xbar logo: a circle with three dots inside it' src='/public/img/xbar-2048.png' style='width:48px;height:48px;' />
						<span>xbar</span>
					</a>
					<div class='flex-grow'></div>
					<div>
						<a 
							target='github'
							href='https://github.com/sponsors/matryer' 
							class='text-white px-4 py-2 whitespace-nowrap'
						><span class='mr-1'>üíú</span> Sponsor</a>
					</div>
					<div class='hidden md:block'>
						<a 
							target='github'
							href='/dl' 
							class='rounded bg-white text-gray-800 hover:text-black px-4 py-2 shadow hover:shadow-lg whitespace-nowrap'
						>Coming soon</a>
					</div>
				</div>
			</div>
		</header>
		<div id='menubar' class='text-white whitespace-nowrap overflow-hidden flex flex-wrap justify-end items-center text-right'>
			
			
				<a 
					
					href='/docs/plugins/AWS.html'
				>
					AWS
				</a>
			
				<a 
					
					href='/docs/plugins/Cryptocurrency.html'
				>
					Cryptocurrency
				</a>
			
				<a 
					
					href='/docs/plugins/Dev.html'
				>
					Dev
				</a>
			
				<a 
					
					href='/docs/plugins/E-Commerce.html'
				>
					E-Commerce
				</a>
			
				<a 
					
					href='/docs/plugins/Email.html'
				>
					Email
				</a>
			
				<a 
					
					href='/docs/plugins/Environment.html'
				>
					Environment
				</a>
			
				<a 
					
					href='/docs/plugins/Finance.html'
				>
					Finance
				</a>
			
				<a 
					
					href='/docs/plugins/Games.html'
				>
					Games
				</a>
			
				<a 
					
					href='/docs/plugins/IoT.html'
				>
					IoT
				</a>
			
				<a 
					
					href='/docs/plugins/Lifestyle.html'
				>
					Lifestyle
				</a>
			
				<a 
					
					href='/docs/plugins/Music.html'
				>
					Music
				</a>
			
				<a 
					
					href='/docs/plugins/Network.html'
				>
					Network
				</a>
			
				<a 
					
					href='/docs/plugins/Politics.html'
				>
					Politics
				</a>
			
				<a 
					
					href='/docs/plugins/Science.html'
				>
					Science
				</a>
			
				<a 
					
					href='/docs/plugins/Sports.html'
				>
					Sports
				</a>
			
				<a 
					
					href='/docs/plugins/System.html'
				>
					System
				</a>
			
				<a 
					 class='rounded selected' 
					href='/docs/plugins/Time.html'
				>
					Time
				</a>
			
				<a 
					
					href='/docs/plugins/Tools.html'
				>
					Tools
				</a>
			
				<a 
					
					href='/docs/plugins/Travel.html'
				>
					Travel
				</a>
			
				<a 
					
					href='/docs/plugins/Weather.html'
				>
					Weather
				</a>
			
				<a 
					
					href='/docs/plugins/Web.html'
				>
					Web
				</a>
			
		</div>
		
	<div class='container mx-auto flex flex-wrap space-x-8 justify-start items-start mt-16'>
		<div class='flex flex-col justify-start'>
			<div class='px-8 py-2 max-w-3xl'>
				<h1 class='fancy-font text-white text-6xl'>Pomodoro Timer</h1>
			</div>
			<div class='p-8 text-sm'>
				
					
						
							<div class='flex space-x-4 pb-8'>
								<div class='tiny-photo'>
									<a 
										href='/docs/contributors/mkoura.html'
									>
										<img class='rounded shadow primary' src='https://avatars.githubusercontent.com/u/2352619?v=4'>
									</a>
								</div>
								<div>
									<a 
										href='/docs/contributors/mkoura.html'
										class='light-background rounded-sm shadow-md px-4 py-2 text-white' 
										style='text-decoration: none;'
									>
										Martin Kourim (<code style='color:white;'>@mkoura</code> on GitHub)
									</a>
								</div>
							</div>
						
					
				
				
					<p class='my-8 text-white opacity-75 text-lg max-w-lg'>
						Timer that uses Pomodoro timeboxing
					</p>
				
				<div class='plugin-app-link hidden md:flex items-end p-8 m-8 mb-16 bg-black bg-opacity-25 rounded-lg shadow max-w-md'>
					<div>
						<a 
							href='xbar://app.xbarapp.com/openPlugin?path=Time%2fpomodoro2.30s.sh'
							class='rounded bg-white text-gray-800 hover:text-black px-4 py-2 shadow hover:shadow-lg whitespace-nowrap'
						><span class='mr-1'>üñ•</span> Open in xbar app</a>
					</div>
					<div class='opacity-50 text-sm text-white ml-3'>Requires <a target='github' href='/dl' class='underline'>xbar app</a></div>
				</div>
				
			</div>
		</div>
		<div 
			class='flex flex-col justify-center mb-16'
		>
			<img 
				class='max-w-md w-full'
				src='https://i.imgur.com/WswKpT4.png' 
				alt='Image preview of Pomodoro Timer plugin.'
				onerror='this.onerror=null;this.src="/public/img/xbar-2048.png";'
			/>
		</div>
	</div>

	
		<div class='code-background text-white p-8 pb-24'>
			<div class='container mx-auto'>
				<div class='flex flex-wrap py-8 space-x-4 justify-end'>
					<div>
						<h2 class='md:text-2xl text-bold'>
							<code>pomodoro2.30s.sh</code>
						</h2>
					</div>
					<div class='flex-grow'></div>
					<div>
						<a class='text-sm text-white hover:text-black hover:bg-white px-4 py-2 rounded' target='github' href='https://github.com/matryer/bitbar-plugins/edit/master/Time/pomodoro2.30s.sh'>Edit</a>
					</div>
					<div>
						<a class='text-sm text-gray-700 bg-white hover:bg-gray-100 active:text-black px-4 py-2 rounded' target='github' href='https://github.com/matryer/bitbar-plugins/blob/master/Time/pomodoro2.30s.sh'>Open on GitHub</a>
					</div>
				</div>
				<div>
					<pre class='text-sm whitespace-pre-wrap'><code class='break-all '>#!/bin/bash

# &lt;bitbar.title&gt;Pomodoro Timer&lt;/bitbar.title&gt;
# &lt;bitbar.version&gt;v1.1&lt;/bitbar.version&gt;
# &lt;bitbar.author&gt;Martin Kourim&lt;/bitbar.author&gt;
# &lt;bitbar.author.github&gt;mkoura&lt;/bitbar.author.github&gt;
# &lt;bitbar.desc&gt;Timer that uses Pomodoro timeboxing&lt;/bitbar.desc&gt;
# &lt;bitbar.image&gt;https://i.imgur.com/WswKpT4.png&lt;/bitbar.image&gt;

# pomodoro duration
readonly POMODORO=1500 # 25 min
# break duration
readonly BREAK=240 # 4 min
# long break duration
readonly LONG_BREAK=1200 # 20 min
# script to run (file path)
SCRIPT=&#34;&#34;

# SCRIPT file example
##!/bin/bash
## plays sound when activity is finished
#case &#34;$1&#34; in
#  &#34;finished&#34;|&#34;break_finished&#34;|&#34;long_break_finished&#34; )
#    play some_sound_file
#esac

# icons
readonly TOMATO_ICON=&#34;üçÖ&#34;
readonly BREAK_ICON=&#34;‚òï&#34;
readonly LONG_BREAK_ICON=&#34;üéâ&#34;
readonly PAUSE_BIG_ICON=&#34;‚ñÆ‚ñÆ&#34;
readonly PAUSE_ICON=&#34;‚è∏&#34;
readonly STOP_ICON=&#34;‚èπ&#34;
readonly CHECKED_ICON=&#34;‚úì&#34;
readonly UNCHECKED_ICON=&#34;‚úó&#34;

# ---

# must be updated at least every $MAX_UPDATE_INTERVAL seconds
readonly MAX_UPDATE_INTERVAL=60

# file for saving status
readonly STATUS_FILE=&#34;$HOME/.bitbar_pomodoro&#34;

# running on Linux or Mac OS X?
[ -e /proc/uptime ] &amp;&amp; LINUX=&#34;true&#34; || LINUX=&#34;&#34;
readonly LINUX

# checks if script is executable
[ -x &#34;$SCRIPT&#34; ] || SCRIPT=&#34;&#34;
readonly SCRIPT

# saves current timestamp to the &#34;now&#34; variable
set_now() {
  [ -n &#34;$now&#34; ] &amp;&amp; return

  # avoid spawning processes if possible
  if [ -n &#34;$LINUX&#34; ]; then
    now=&#34;$(read -r s _  &lt; /proc/uptime &amp;&amp; echo &#34;${s%.*}&#34;)&#34;
  else
    now=&#34;$(date &#43;%s)&#34;
  fi
}

run_script() {
  [ -n &#34;$SCRIPT&#34; ] &amp;&amp; $SCRIPT &#34;$@&#34; &amp;
}

# displays desktop notification
notify_osd() {
  if [ -n &#34;$LINUX&#34; ]; then
    notify-send &#34;$@&#34; 2&gt;/dev/null
  else
    osascript -e &#34;display notification \&#34;$*\&#34; with title \&#34;$TOMATO_ICON Pomodoro\&#34;&#34; 2&gt;/dev/null
  fi
}

# writes current status to status file
status_write() {
  echo &#34;$tstamp $togo $pomodoros $state $activity $loop&#34; &gt; &#34;$STATUS_FILE&#34;
}

# resets the status file
status_reset() {
  tstamp=0; togo=0; pomodoros=0; state=&#34;STOP&#34;; activity=&#34;pomodoro&#34;; loop=&#34;${loop:-on}&#34;
  status_write
}

# toggles whether to loop pomodoros
loop_toggle() {
  [ &#34;$loop&#34; = &#34;on&#34; ] &amp;&amp; loop=&#34;off&#34; || loop=&#34;on&#34;
  status_write
}

# starts pomodoro
pomodoro_start() {
  set_now
  tstamp=&#34;$now&#34;; togo=&#34;$POMODORO&#34;; state=&#34;RUN&#34;; activity=&#34;pomodoro&#34;
  status_write
  run_script start
}

# starts break
pomodoro_break() {
  set_now
  tstamp=&#34;$now&#34;; togo=&#34;$BREAK&#34;; state=&#34;RUN&#34;; activity=&#34;break&#34;
  status_write
  run_script break
}

# starts long break
pomodoro_long_break() {
  set_now
  tstamp=&#34;$now&#34;; togo=&#34;$LONG_BREAK&#34;; pomodoros=0; state=&#34;RUN&#34;; activity=&#34;long_break&#34;
  status_write
  run_script long_break
}

# detects stale records, i.e. when computer
# was turned off during pomodoro
stale_record() {
  case &#34;$activity&#34; in
    &#34;pomodoro&#34;)
      local interval=&#34;$POMODORO&#34;
      ;;
    &#34;break&#34;)
      local interval=&#34;$BREAK&#34;
      ;;
    &#34;long_break&#34;)
      local interval=&#34;$LONG_BREAK&#34;
      ;;
  esac
  if ((tdiff &lt; 0)) || ((tdiff &gt; (interval &#43; MAX_UPDATE_INTERVAL &#43; 1) )); then
    status_reset
    return 1
  fi
  return 0
}

# checks if activity is finished
# notifies if so and starts a new activity
pomodoro_update() {
  case &#34;$state&#34; in
    &#34;STOP&#34;|&#34;PAUSE&#34;)
      return
      ;;
    &#34;RUN&#34;)
      ;;
    *)
      status_reset
      return
      ;;
  esac

  # RUN
  set_now
  tdiff=&#34;$((now - tstamp))&#34;
  stale_record || return 1
  case &#34;$activity&#34; in
    &#34;pomodoro&#34;)
      togo=&#34;$((POMODORO - tdiff))&#34;
      if [ &#34;$togo&#34; -le 0 ]; then
        pomodoros=&#34;$((${pomodoros:-0} &#43; 1))&#34;
        run_script finished
        if [ &#34;$pomodoros&#34; -lt 4 ]; then
          notify_osd &#34;Pomodoro completed, take a break.&#34;
          pomodoro_break
        else
          notify_osd &#34;Four pomodoros completed, take a long break.&#34;
          pomodoro_long_break
        fi
      fi
      ;;
    &#34;break&#34;)
      togo=&#34;$((BREAK - tdiff))&#34;
      if [ &#34;$togo&#34; -le 0 ]; then
        run_script break_finished
        if [ &#34;$loop&#34; = &#34;off&#34; ]; then
          notify_osd &#34;Break is over.&#34;
          status_reset
        else
          notify_osd &#34;Break is over, focus on new pomodoro.&#34;
          pomodoro_start
        fi
      fi
      ;;
    &#34;long_break&#34;)
      togo=&#34;$((LONG_BREAK - tdiff))&#34;
      if [ &#34;$togo&#34; -le 0 ]; then
        run_script long_break_finished
        if [ &#34;$loop&#34; = &#34;off&#34; ]; then
          notify_osd &#34;Long break is over.&#34;
          status_reset
        else
          notify_osd &#34;Long break is over, focus on new pomodoro.&#34;
          pomodoro_start
        fi
      fi
      ;;
    *)
      status_reset
      ;;
  esac
}

# pauses or resumes activity
pause_resume() {
  pomodoro_update
  case &#34;$state&#34; in
    &#34;RUN&#34;)
      # pause
      state=&#34;PAUSE&#34;
      status_write # saves also up-to-date &#34;togo&#34;
      run_script pause
      ;;
    &#34;PAUSE&#34;)
      # resume
      set_now
      # sets new timestamp according to the saved &#34;togo&#34;
      case &#34;$activity&#34; in
        &#34;pomodoro&#34;)
          tstamp=&#34;$((now - (POMODORO - togo) ))&#34;
          ;;
        &#34;break&#34;)
          tstamp=&#34;$((now - (BREAK - togo) ))&#34;
          ;;
        &#34;long_break&#34;)
          tstamp=&#34;$((now - (LONG_BREAK - togo) ))&#34;
          ;;
      esac
      state=&#34;RUN&#34;
      status_write
      run_script resume
      ;;
    *)
      status_reset
      ;;
  esac
}

# calculates remaining time
# saves remaining minutes to &#34;rem&#34;
# saves remaining seconds to &#34;res&#34;
calc_remaining_time() {
  [ -n &#34;$rem&#34; ] &amp;&amp; return
  rem=&#34;$((togo / 60 % 60))&#34;
  res=&#34;$((togo % 60))&#34;
}

# prints remaining time in MIN:SEC format
print_remaining_time() {
  calc_remaining_time
  printf &#34;%02d:%02d&#34; &#34;$rem&#34; &#34;$res&#34;
}

# prints remaining time in whole minutes
print_remaining_minutes() {
  calc_remaining_time
  if [ &#34;$rem&#34; -eq 0 ]; then
    printf &#34;&amp;lt;1m&#34;
  else
    [ &#34;$res&#34; -ge 30 ] &amp;&amp; remaining=&#34;$((rem &#43; 1))&#34; || remaining=&#34;$rem&#34;
    printf &#34;%02dm&#34; &#34;$remaining&#34;
  fi
}

# prints menu for argos/bitbar
print_menu() {
  case &#34;$state&#34; in
    &#34;STOP&#34;)
      echo &#34;$TOMATO_ICON&#34;
      echo &#34;---&#34;
      echo &#34;Pomodoro | bash=\&#34;$0\&#34; param1=start terminal=false refresh=true&#34;
      echo &#34;Break | bash=\&#34;$0\&#34; param1=break terminal=false refresh=true&#34;
      echo &#34;Long break | bash=\&#34;$0\&#34; param1=long_break terminal=false refresh=true&#34;
      ;;
    &#34;RUN&#34;)
      case &#34;$activity&#34; in
        &#34;pomodoro&#34;)
          echo &#34;$TOMATO_ICON $(print_remaining_minutes)&#34;
          local caption=&#34;&#34;
          ;;
        &#34;break&#34;)
          echo &#34;$BREAK_ICON $(print_remaining_minutes)&#34;
          local caption=&#34;Break: &#34;
          ;;
        &#34;long_break&#34;)
          echo &#34;$LONG_BREAK_ICON $(print_remaining_minutes)&#34;
          local caption=&#34;Long break: &#34;
          ;;
      esac
      echo &#34;---&#34;
      echo &#34;${caption}$(print_remaining_time) | refresh=true&#34;
      echo &#34;${PAUSE_ICON} pause | bash=\&#34;$0\&#34; param1=pause terminal=false refresh=true&#34;
      echo &#34;${STOP_ICON} stop | bash=\&#34;$0\&#34; param1=stop terminal=false refresh=true&#34;
      ;;
    &#34;PAUSE&#34;)
      echo &#34;$PAUSE_BIG_ICON $(print_remaining_minutes)&#34;
      echo &#34;---&#34;
      case &#34;$activity&#34; in
        &#34;pomodoro&#34;)
          local caption=&#34;Paused&#34;
          ;;
        &#34;break&#34;)
          local caption=&#34;Break&#34;
          ;;
        &#34;long_break&#34;)
          local caption=&#34;Long break&#34;
          ;;
      esac
      echo &#34;${caption}: $(print_remaining_time) | refresh=true&#34;
      echo &#34;${PAUSE_ICON} resume | bash=\&#34;$0\&#34; param1=pause terminal=false refresh=true&#34;
      echo &#34;${STOP_ICON} stop | bash=\&#34;$0\&#34; param1=stop terminal=false refresh=true&#34;
      ;;
  esac

  echo &#34;---&#34;
  if [ &#34;$loop&#34; = &#34;off&#34; ]; then local acheck=&#34;$UNCHECKED_ICON&#34;; else local acheck=&#34;$CHECKED_ICON&#34;; fi
  echo &#34;Loop pomodoros: ${acheck} | bash=\&#34;$0\&#34; param1=loop_toggle terminal=false refresh=true&#34;
}

main() {
  [ ! -e &#34;$STATUS_FILE&#34; ] &amp;&amp; : &gt; &#34;$STATUS_FILE&#34;

  # reads current status from status file
  read -r tstamp togo pomodoros state activity loop _ \
    &lt; &lt;({ read -r line; echo &#34;$line&#34;; } &lt; &#34;$STATUS_FILE&#34;)

  case &#34;$1&#34; in
    &#34;start&#34;)
      pomodoro_start
      ;;
    &#34;stop&#34;)
      status_reset
      run_script stop
      ;;
    &#34;pause&#34;)
      pause_resume
      ;;
    &#34;break&#34;)
      pomodoro_break
      ;;
    &#34;long_break&#34;)
      pomodoro_long_break
      ;;
    &#34;loop_toggle&#34;)
      loop_toggle
      ;;
    *)
      pomodoro_update
      ;;
  esac

  print_menu
}

main &#34;$@&#34;
</code></pre>
				</div>
			</div>
		</div>
	

		<footer class='container mx-auto text-white text-lg opacity-75 mt-8'>
			<div class='text-center p-16'>
				<p>
					<div>
						<a target='github' class='underline hover:text-white' href='https://github.com/matryer/xbar'>GitHub project</a>
						‚Ä¢
						<a target='github' class='underline hover:text-white' href='https://github.com/matryer/xbar#writing-plugins'>Writing plugins guide</a>
					</div>
					<div class='mt-8'>
						Copyright &copy;2021 Mat Ryer + contributors ‚Ä¢ <a target='twitter' class='underline hover:text-white' href='https://twitter.com/matryer'>@matryer</a>
					</div>
					<div class='opacity-50 mt-2'>
						Last updated on 08 Mar 21 15:22 GMT
					</div>
				</p>
			</div>
		</footer>
	</body>
</html>
