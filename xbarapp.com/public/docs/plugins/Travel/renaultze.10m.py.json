{
	"plugin": {
		"files": [
			{
				"path": "Travel/renaultze.10m.py",
				"filename": "renaultze.10m.py",
				"content": "#!/opt/local/bin/python\n# -*- coding: utf-8 -*-\n#\n# \u003cbitbar.title\u003eRenault Zero Emission\u003c/bitbar.title\u003e\n# \u003cbitbar.version\u003ev1.0\u003c/bitbar.version\u003e\n# \u003cbitbar.author\u003eAntoine Coetsier\u003c/bitbar.author\u003e\n# \u003cbitbar.author.github\u003eretrack\u003c/bitbar.author.github\u003e\n# \u003cbitbar.desc\u003ePulls your Renault EV battery status current and estimated\u003c/bitbar.desc\u003e\n# \u003cbitbar.image\u003ehttp://i.imgur.com/Wb1IUoO.png\u003c/bitbar.image\u003e\n#\n# Installation:\n# 1/ adjust your Python Binary location (embedded, Homebrew or Macports)\n# 2/ install request module with \"sudo pip install requests\"\n# 3/ change user and password to your my.renault.com credentials\n\nimport requests\nimport xml.etree.ElementTree as ET\n\nuser = \"email address\"\npassword = \"your password\"\n\n\nheaders = {'Content-Type': 'text/xml'}\n\n# forge the authentication payload\nxml = \"\"\"\n\u003cns1:SmartphoneNewLoginRequest xmlns:ns1=\"urn:com:renault:smartphone.userservices:v1\" xmlns:ns3=\"urn:com:renault:gdc:type:user:v1\" xmlns:ns4=\"urn:com:hitachi:gdc:type:authenticationmanagercommon:v1\" xmlns:ns2=\"urn:com:hitachi:gdc:type:authenticationmanagercommon:v1\"\u003e\n   \u003cSmartphoneNewLoginInfo\u003e\n           \u003cns1:UserNewLoginInfo\u003e\n                   \u003cns4:UserId\u003e{0}\u003c/ns4:UserId\u003e\n                   \u003cns4:Password\u003e{1}\u003c/ns4:Password\u003e\n           \u003c/ns1:UserNewLoginInfo\u003e\n           \u003cns1:DeviceToken\u003e\u003c/ns1:DeviceToken\u003e\n           \u003cns1:UUID\u003e\u003c/ns1:UUID\u003e\n           \u003cns1:Locale\u003eFR\u003c/ns1:Locale\u003e\n           \u003cns1:AppVersion\u003e\u003c/ns1:AppVersion\u003e\n           \u003cns1:SmartphoneType\u003eIPHONE\u003c/ns1:SmartphoneType\u003e\n           \u003cCountryCode\u003eFR\u003c/CountryCode\u003e\n   \u003c/SmartphoneNewLoginInfo\u003e\n\u003c/ns1:SmartphoneNewLoginRequest\u003e\n\"\"\"\n\nurl = \"https://rno-smartgtw.viaaq.eu/aqPortal/B2CSmartphoneProxy/\"\n\n# perform a user/password authentication\nr = requests.post(url + \"UserService\",data=xml.format(user, password), headers=headers)\nsession = r.headers.get('Set-Cookie').split(';')[0]\ncookie = session.split('=')[1]\n\n# extract VIN number for subsequent requests\nroot = ET.fromstring(r.content)\nfor a in root.findall('.//{urn:com:renault:gdc:type:portalcommon:v1}VIN'):\n    vin = a.text\n\n# forge the dashboard payload\nxml = \"\"\"\n\u003cns4:SmartphoneGetNewCurrentDataRequest xmlns:ns3=\"urn:com:renault:gdc:type:portalcommon:v1\" xmlns:ns4=\"urn:com:renault:gdc:type:smartphoneEvDashboard:v1\" xmlns:ns2=\"urn:com:renault:gdc:type:evDashboard:v1\"\u003e\n        \u003cns3:VehicleServiceRequestHeader\u003e\n                \u003cns3:VIN\u003e{0}\u003c/ns3:VIN\u003e\n                \u003cns3:Caller\u003eSMARTPHONE-APP\u003c/ns3:Caller\u003e\n        \u003c/ns3:VehicleServiceRequestHeader\u003e\n\u003c/ns4:SmartphoneGetNewCurrentDataRequest\u003e\n\"\"\"\n\nr1 = requests.post(url + \"EvDashboardService\",data=xml.format(vin), headers=headers, cookies=r.cookies)\n\nroot = ET.fromstring(r1.content)\nfor a in root.findall('.//{urn:com:renault:gdc:type:evDashboard:v1}BatteryRemainingPercent'):\n    BatteryRemainingPercent = a.text\n    print(BatteryRemainingPercent + \" %\")\n    break\nfor a in root.findall('.//{urn:com:renault:gdc:type:evDashboard:v1}CruisingRange'):\n    CruisingRange = a.text\n    print(CruisingRange + \" km\")\nprint(\"---\")\nprint(\"VIN: \" + vin)\n"
			}
		],
		"path": "Travel/renaultze.10m.py",
		"filename": "renaultze.10m.py",
		"dir": "Travel",
		"docsPlugin": "Travel/renaultze.10m.py.html",
		"docsCategory": "Travel.html",
		"pathSegments": [
			"Travel"
		],
		"categoryPathSegments": [
			{
				"path": "Travel",
				"text": "Travel",
				"isLast": true
			}
		],
		"title": "Renault Zero Emission",
		"version": "v1.0",
		"author": "Antoine Coetsier",
		"authors": [
			{
				"name": "Antoine Coetsier",
				"githubUsername": "retrack",
				"imageURL": "https://avatars.githubusercontent.com/u/1295273?v=4",
				"bio": "",
				"primary": true
			}
		],
		"desc": "Pulls your Renault EV battery status current and estimated",
		"imageURL": "http://i.imgur.com/Wb1IUoO.png",
		"dependencies": null,
		"aboutURL": "",
		"lastUpdated": "2021-03-08T15:22:08.334108Z",
		"vars": null
	}
}