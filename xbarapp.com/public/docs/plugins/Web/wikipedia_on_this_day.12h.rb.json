{
	"plugin": {
		"files": [
			{
				"path": "Web/wikipedia_on_this_day.12h.rb",
				"filename": "wikipedia_on_this_day.12h.rb",
				"content": "#!/usr/bin/env ruby\n# \u003cbitbar.title\u003eWikipedia On This Day\u003c/bitbar.title\u003e\n# \u003cbitbar.version\u003e0.1.0\u003c/bitbar.version\u003e\n# \u003cbitbar.author\u003eRyan Scott Lewis\u003c/bitbar.author\u003e\n# \u003cbitbar.author.github\u003eRyanScottLewis\u003c/bitbar.author.github\u003e\n# \u003cbitbar.desc\u003eDisplay Wikipedia On This Day information.\u003c/bitbar.desc\u003e\n# \u003cbitbar.dependencies\u003eruby (wikipedia, wikicloth, nokogiri rubygems)\u003c/bitbar.dependencies\u003e\n\nrequire \"wikipedia\" # gem install wikipedia-client\nrequire \"wikicloth\" # gem install wikicloth\nrequire \"nokogiri\"  # gem install nokogiri\n\ndef convert_wiki_to_html(data)\n  WikiCloth::Parser.new(data: data).to_html\nend\n\nday_str = Time.now.strftime(\"%B %e\")\npage = Wikipedia.find(day_str, prop: \"revisions\", rvprop: \"content\")\n\nwithin_events_section = false\nlines = page.content.lines.each_with_object([]) do |line, memo|\n\n  html = convert_wiki_to_html(line)\n  html_document = Nokogiri::HTML(html)\n\n  headline_node = html_document.xpath(\"//h2/span[@class='mw-headline']\").first\n\n  if !headline_node.nil?\n    within_events_section = headline_node.text == \"Events\"\n  else\n    next unless within_events_section\n\n    list_item_node = html_document.xpath(\"//ul/li\")\n\n    memo \u003c\u003c  list_item_node.text\n  end\nend\n\nputs \"â“¦\"\nputs \"---\"\nlines.each { |line| puts(line) }\n\n# TODO:\n# * Links!\n# * Sort by date\n# * Date format\n# * Strip references: \"[1]\", etc\n"
			}
		],
		"path": "Web/wikipedia_on_this_day.12h.rb",
		"filename": "wikipedia_on_this_day.12h.rb",
		"dir": "Web",
		"docsPlugin": "Web/wikipedia_on_this_day.12h.rb.html",
		"docsCategory": "Web.html",
		"pathSegments": [
			"Web"
		],
		"categoryPathSegments": [
			{
				"path": "Web",
				"text": "Web",
				"isLast": true
			}
		],
		"title": "Wikipedia On This Day",
		"version": "0.1.0",
		"author": "Ryan Scott Lewis",
		"authors": [
			{
				"name": "Ryan Scott Lewis",
				"githubUsername": "RyanScottLewis",
				"imageURL": "https://avatars.githubusercontent.com/u/39534?v=4",
				"bio": "",
				"primary": true
			}
		],
		"desc": "Display Wikipedia On This Day information.",
		"imageURL": "https://xbarapp.com/public/img/xbar-2048.png",
		"dependencies": [
			"ruby (wikipedia",
			"wikicloth",
			"nokogiri rubygems)"
		],
		"aboutURL": "",
		"lastUpdated": "2021-03-08T15:22:10.567245Z",
		"vars": null
	}
}